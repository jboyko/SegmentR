d2 = as.numeric(dat$TipStates == 1 | dat$TipStates == 2))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d1
cor_d2
cor_d
Q
Q <- corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1
dropStateMatPars(corr_model_1)
corr_model_1
dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q
Q[1,2] <- 1
Q[2,4] <- 1
Q
corr_model_1
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
corr_model_1
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
Q
Q[is.na(Q)]
Q[is.na(Q)] <- 0
Q
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 1 | dat$TipStates == 3),
d2 = as.numeric(dat$TipStates == 1 | dat$TipStates == 2))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d1
cor_d2
cor_d
corr_model_1
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 1 | dat$TipStates == 3),
d2 = as.numeric(dat$TipStates == 1 | dat$TipStates == 2))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d1
cor_d2
cor_d
cor_d1
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 1 | dat$TipStates == 3),
d2 = as.numeric(dat$TipStates == 1 | dat$TipStates == 2))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 1 | dat$TipStates == 3),
d2 = as.numeric(dat$TipStates == 1 | dat$TipStates == 2))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d1
cor_d2
cor_d
Q
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[is.na(Q)] <- 0
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 1 | dat$TipStates == 3),
d2 = as.numeric(dat$TipStates == 1 | dat$TipStates == 2))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
d
cor_d
corr_model_1
d
table(dat$TipStates)
d
dat$TipStates
table(dat$TipStates)
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 1 | dat$TipStates == 2),
d2 = as.numeric(dat$TipStates == 1 | dat$TipStates == 3))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
dat$TipStates
corr_model_1
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates != 1 | dat$TipStates != 3),
d2 = as.numeric(dat$TipStates != 1 | dat$TipStates != 2))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
d
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
as.numeric(dat$TipStates == 1 | dat$TipStates == 3),
as.numeric(dat$TipStates == 1 | dat$TipStates == 3)
corr_model_1
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 2 | dat$TipStates == 4),
d2 = as.numeric(dat$TipStates == 3 | dat$TipStates == 4))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
table(dat$TipStates)
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 2 | dat$TipStates == 4),
d2 = as.numeric(dat$TipStates == 3 | dat$TipStates == 4))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d
cor_d2
cor_d1
cor_d2
cor_d
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
corr_model_1
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5,6,8)))
corr_model_1
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 2 | dat$TipStates == 4),
d2 = as.numeric(dat$TipStates == 3 | dat$TipStates == 4))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d
cor_d1
cor_d2
cor_d
cor_d1
cor_d2
cor_d
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
# corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5,6,8)))
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5,6,8)))
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
# corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
corr_model_1
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,6)))
corr_model_1
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 2 | dat$TipStates == 4),
d2 = as.numeric(dat$TipStates == 3 | dat$TipStates == 4))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d
cor_d1
cor_d2
cor_d1
cor_d2
cor_d
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
corr_model_1
# corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,6)))
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
corr_model_1
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 2 | dat$TipStates == 4),
d2 = as.numeric(dat$TipStates == 3 | dat$TipStates == 4))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d1
cor_d2
cor_d
corr_model_1 <- getStateMat4Dat(data, "ARD", collapse = FALSE,   indep = FALSE)$rate.mat
corr_model_1 <- dropStateMatPars(corr_model_1, c(5, 8))
Q <- corr_model_1
Q[corr_model_1>0] <- 1/4
Q[1,2] <- 1
Q[2,4] <- 1
Q[is.na(Q)] <- 0
# corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,6)))
corr_model_1 <- equateStateMatPars(corr_model_1, list(c(1,2,4,5)))
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
phy <- sim.bdtree(n=1000)
phy$edge.length <- phy$edge.length/max(branching.times(phy))
dat <- simMarkov(phy, Q, c(1,0,0,0))
table(dat$TipStates)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
d = data.frame(sp = phy$tip.label,
d1 = as.numeric(dat$TipStates == 2 | dat$TipStates == 4),
d2 = as.numeric(dat$TipStates == 3 | dat$TipStates == 4))
d1 = data.frame(sp = phy$tip.label, d1 = d$d1)
d2 = data.frame(sp = phy$tip.label, d1 = d$d2)
cor_d1 <- corHMM(phy, data = d1, 1, root.p = c(1,0))
cor_d2 <- corHMM(phy, data = d2, 1, root.p = c(1,0))
cor_d <- corHMM(phy, data = d, 1, root.p = c(1,0,0,0), rate.mat = corr_model_1)
cor_d1
cor_d2
cor_d
plot(x = 1:100, y = 1/(1:100))
dev.off()
plot(x = 1:100, y = 1/(1:100), type='l')
plot(x = log(1:100), y = log(1/(1:100)), type='l')
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 16, col = dat$TipStates, cex = 0.5)
dat$TipStates
d1
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
d1
tiplabels(pch = 21, bg.col = d1$d1, cex = 0.5)
tiplabels(pch = 21, bgcol = d1$d1, cex = 0.5)
tiplabels(pch = 21, col.bg = d1$d1, cex = 0.5)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.1)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.01)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.02)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.03)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.01)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.03)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.014)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.014)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.03)
plot(phy, show.tip.label = FALSE, type = "fan", no.margin = TRUE)
tiplabels(pch = 21, bg = d1$d1, cex = 0.5, offset = 0.014)
tiplabels(pch = 21, bg = d2$d1, cex = 0.5, offset = 0.03)
corr_model_1
